---
project:
  type: default   # convierte la carpeta en proyecto Quarto

metadata-files:
  - ../multi.yml 
title: ""
subtitle: "*Taller de Metodología de Investigación I*"
author: "Dr. Jorge E. Bracamontes G."
format:
  revealjs:
    transition: zoom
    transition-speed: slow
    theme: night
    hash: true
    center: true
    css: [fondo.css]
    incremental: true
    title-slide-attributes:
      data-background-image: "images/fn.png"
      data-background-size: "cover"
      data-background-opacity: "1.0"
---




<script>
document.addEventListener('DOMContentLoaded', (event) => {
    // 1. FILTRO DE SEGURIDAD: Si la URL tiene 'print-pdf', no ejecutar nada.
    if (window.location.search.match(/print-pdf/gi)) {
        console.log("Modo impresión detectado: Desactivando scripts interactivos.");
        return; 
    }

    const synth = window.speechSynthesis;
    let utterance;
    let paused = false;

    // Crear botón de pantalla completa
    const fullscreenButton = document.createElement('button');
    fullscreenButton.id = 'fullscreenButton';
    fullscreenButton.textContent = 'Pantalla Completa';
    fullscreenButton.style.cssText = `
        position: fixed; bottom: 20px; left: 20px; z-index: 1000;
        padding: 12px 20px; background-color: #ff7300; color: #ffffcc;
        border: none; border-radius: 12px; font-size: 16px;
        font-weight: bold; cursor: pointer; box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    `;
    document.body.appendChild(fullscreenButton);

    // Funciones de lectura
    const readIncrementalContent = (element) => {
        if (utterance && synth.speaking) synth.cancel();
        let textToRead = element.textContent;
        if (textToRead.trim() !== '') {
            utterance = new SpeechSynthesisUtterance(textToRead);
            const voices = synth.getVoices();
            const voice = voices.find(v => v.lang.startsWith('es-'));
            if (voice) utterance.voice = voice;
            synth.speak(utterance);
        }
    };

    const readCurrentSlide = () => {
        if (utterance && synth.speaking) synth.cancel();
        const currentSlide = document.querySelector('.present');
        if (!currentSlide) return;
        const visibleElements = currentSlide.querySelectorAll('h1,h2,h3,h4,h5,h6,p,li:not([aria-hidden="true"]):not(.fragment)');
        let textToRead = '';
        visibleElements.forEach((el) => {
            if (getComputedStyle(el).display !== 'none') textToRead += el.textContent + ' ';
        });
        if (textToRead.trim() !== '') {
            utterance = new SpeechSynthesisUtterance(textToRead);
            const voices = synth.getVoices();
            const voice = voices.find(v => v.lang.startsWith('es-'));
            if (voice) utterance.voice = voice;
            synth.speak(utterance);
        }
    };

    // Eventos de teclado y Reveal
    document.addEventListener('keydown', (e) => {
        if (e.key.toLowerCase() === 'q') {
            paused ? synth.resume() : synth.pause();
            paused = !paused;
        }
    });

    // Solo activar eventos de Reveal si Reveal existe
    if (typeof Reveal !== 'undefined') {
        Reveal.on('slidechanged', () => readCurrentSlide());
        Reveal.on('fragmentshown', (e) => readIncrementalContent(e.fragment));
    }

    // Botón Reproducir
    const playButton = document.createElement('button');
    playButton.textContent = 'Reproducir';
    playButton.style.cssText = `
        position: fixed; bottom: 20px; right: 20px; z-index: 1000;
        padding: 10px 20px; font-size: 16px; background-color: #007bff;
        color: white; border: none; border-radius: 5px; cursor: pointer;
    `;
    document.body.appendChild(playButton);

    playButton.addEventListener('click', () => {
        if (synth.speaking) {
            synth.cancel();
            playButton.textContent = 'Reproducir';
        } else {
            readCurrentSlide();
            playButton.textContent = 'Detener';
        }
    });

    // Lógica Pantalla Completa
    fullscreenButton.addEventListener('click', () => {
        if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen?.();
        } else {
            document.exitFullscreen?.();
        }
    });

    document.addEventListener('fullscreenchange', () => {
        fullscreenButton.style.display = document.fullscreenElement ? 'none' : 'block';
    });
});
</script>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const fullscreenButton = document.getElementById('fullscreenButton');
    function toggleFullscreen() {
        if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen?.();
        } else {
            document.exitFullscreen?.();
        }
    }
    function handleFullscreenChange() {
        fullscreenButton.style.display = document.fullscreenElement ? 'none' : 'block';
    }
    if (fullscreenButton) {
        fullscreenButton.addEventListener('click', toggleFullscreen);
        document.addEventListener('fullscreenchange', handleFullscreenChange);
    }
});
</script>
